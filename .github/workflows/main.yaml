name: Main
'on':
  push:
    branches:
      - main
  pull_request:
    branches:
      - main
concurrency:
  group: '${{ github.ref }}'
  cancel-in-progress: true
jobs:
  Validations:
    name: Unit Tests
    runs-on: self-hosted
    env:
      GOPATH: '${{ github.workspace }}'
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        with:
          path: '${{ env.GOPATH }}/src/github.com/${{ github.repository }}'
      - uses: actions/setup-go@v5
        with:
          go-version: 1.23.2
          cache: false
      - name: Run Unit Tests
        run: |
          cd ${{ env.GOPATH }}/src/github.com/${{ github.repository }}
          make test
      - name: Run Gosec Security Scanner
        run: |
          cd ${{ env.GOPATH }}/src/github.com/${{ github.repository }}
          make gosec
      - name: Run Gosec Security Scanner
        run: |
          cd ${{ env.GOPATH }}/src/github.com/${{ github.repository }}
          make spell-check
      - name: Lint Go files
        uses: golangci/golangci-lint-action@v6
        with:
          version: v1.60
          args: --timeout 180s --new
#   go-lint:
#     name: Go Lint
#     runs-on: self-hosted
#     env:
#       GOPATH: '${{ github.workspace }}'
#     permissions:
#       contents: read
#       pull-requests: read
#       checks: write
#     steps:
#       - name: Checkout Code
#         uses: actions/checkout@v4
#         with:
#           path: '${{ env.GOPATH }}/src/github.com/${{ github.repository }}'
#       - uses: actions/setup-go@v5
#         with:
#           go-version: 1.23.2
#           cache: false
#         name: Setup Golang
#       - name: Lint Go files
#         uses: golangci/golangci-lint-action@v6
#         with:
#           version: v1.60
#           args: >-
#             --timeout 180s --new --exclude-dirs  example
#             --allow-parallel-runners ${{ env.GOPATH }}/src/github.com/${{ github.repository }}